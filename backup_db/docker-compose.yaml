services:
  tgfp-db-backup:
    image: johnofcamas/tgfp-job-runner
    container_name: tgfp-db-backup
    environment:
      - TZ
      - BACKUP_DIR=/backup
      - HEALTHCHECK_BASE_URL
      - MONGO_HOST=mongo
      - MONGO_INITDB_ROOT_USERNAME
      - MONGO_INITDB_ROOT_PASSWORD
      - MONGO_PORT=$MONGO_PORT_EXTERNAL
      - SCHEDULE=1 minute

    restart: unless-stopped
    volumes:
      - $TGFP_HOME/backup_db/scripts:/app/scripts
      - $MONGO_BACKUP_DIR:/backup
    depends_on:
      tgfp-mongodb:
        condition: service_started
